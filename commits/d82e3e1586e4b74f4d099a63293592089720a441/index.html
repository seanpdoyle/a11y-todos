<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Use the title from a page's frontmatter if it has one -->
    <title>Delay multiple Tasks
</title>
    <link href="../../stylesheets/site.css" rel="stylesheet" />
    <script src="../../javascripts/site.js"></script>
  </head>
  <body class="page">
    <header class="header">
      <h1 class="header__name">
<a href="../../">          a11y-todos
</a>      </h1>


      <nav class="
        header__navigation
        navigation
        
      ">
<a href="../08fb54ffa3ba144ad1f1bb0ac787b52410c6b73d/">              &#8592; Previous
</a>
<a href="../2d12a66c44d7cc7e920a31aebd0c6ced6c886f16/">              Next &#8594;
</a>      </nav>
    </header>

    <main class="content">
      <details class="accordion content__item">
        <summary class="accordion__summary">
          <div class="accordion__closed">
            <nav class="
              commit-history
              u-db-overflow-y--auto
              u-mb-overflow-x--scroll
            ">
                <a href="../4940917510781bfb9d2314695ec402b2e1609f98/" class="commit-node commit-node--collapsed" title="[SKIP]: Create `git-read` GitHub Action
"></a>
                <a href="../b7dd0dfeec5d3ea4332f21d545383e90fdca0358/" class="commit-node commit-node--collapsed" title="[SKIP]: State project goals in a README"></a>
                <a href="../97ec982181dad3d2765c18bd5440eccdbbc98500/" class="commit-node commit-node--collapsed" title="[GENERATED]: Initial Commit
"></a>
                <a href="../3fcacf98b7605fbfe2906a20f60d8c312c6e0a52/" class="commit-node commit-node--collapsed" title="[GENERATED]: Generate db/schema.rb
"></a>
                <a href="../dcabcd47c7eb462c872908b002a41be5df59eec5/" class="commit-node commit-node--collapsed" title="Section 1: The Rails"></a>
                <a href="../08fb54ffa3ba144ad1f1bb0ac787b52410c6b73d/" class="commit-node commit-node--collapsed" title="Mark Tasks as completed
"></a>
                <a href="./" class="commit-node commit-node--collapsed" title="Delay multiple Tasks
" aria-current="page"></a>
                <a href="../2d12a66c44d7cc7e920a31aebd0c6ced6c886f16/" class="commit-node commit-node--collapsed" title="Promote a Task from Delayed back to To-do
"></a>
                <a href="../766e956f153bd69ced2ac7658e7b12ea95fed2db/" class="commit-node commit-node--collapsed" title="Reopen a Task that was Completed
"></a>
                <a href="../72814697aad135b2d6df8a629b462ac152b10281/" class="commit-node commit-node--collapsed" title="Style with TailwindCSS
"></a>
                <a href="../a062d3d1105d243386fc33a13216ead667137d5e/" class="commit-node commit-node--collapsed" title="Section 2: The JavaScript"></a>
                <a href="../d41ae66683d55539e82f439e818ba6f4e60a1cd4/" class="commit-node commit-node--collapsed" title="Open the `&lt;dialog&gt;` with a `&lt;button&gt;`
"></a>
                <a href="../fa19a0708b8f06a54e73435a61c7515dac5cbf4b/" class="commit-node commit-node--collapsed" title="Open Bulk Action `&lt;form&gt;` modally
"></a>
                <a href="../dd46eba462c76aff62ed92bce956c2e66aa07a2a/" class="commit-node commit-node--collapsed" title="Close &lt;dialog&gt; when Bulk selection is empty
"></a>
                <a href="../beae9178b49ccb96764d4b42b474a9776c1ac300/" class="commit-node commit-node--collapsed" title="Fetch the `&lt;dialog&gt;` contents when opened
"></a>
                <a href="../0f366feb8a8edd728134e4cf7a43a4bd06f3305b/" class="commit-node commit-node--collapsed" title="Treat Lists as separate tab stops
"></a>
                <a href="../bc43125b16e2399e8bec4b6cb15b6d5878447b37/" class="commit-node commit-node--collapsed" title="Section 3: How can we improve accessibility?"></a>
                <a href="../6b6627d0dc9eecdd10297746c118d7bb68d586c2/" class="commit-node commit-node--collapsed" title="Mark &lt;main inert&gt; when &lt;dialog&gt; open
"></a>
                <a href="../748b365e5cb08ee91a5fdd7f41d7c96d67c122a5/" class="commit-node commit-node--collapsed" title="Announce selected Task count
"></a>
            </nav>

            <div class="accordion__toggle">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--desktop"><title>Expand History</title>
  <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L10.293 8 4.646 2.354a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--mobile"><title>Expand History</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>

            </div>
          </div>

          <div class="accordion__opened">
            <div class="accordion__toggle accordion__toggle--fill">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--desktop"><title>Collapse History</title>
  <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 010 .708L5.707 8l5.647 5.646a.5.5 0 01-.708.708l-6-6a.5.5 0 010-.708l6-6a.5.5 0 01.708 0z" clip-rule="evenodd"></path>
</svg>


              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--mobile"><title>Collapse History</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>

            </div>
          </div>
        </summary>

        <nav class="
          commit-history
          commit-history--full
          u-db-overflow-y--auto
          u-mb-overflow-x--scroll
        ">
<a href="../4940917510781bfb9d2314695ec402b2e1609f98/" class="commit-node commit-node--full">              <p>[SKIP]: Create <code>git-read</code> GitHub Action</p>

</a><a href="../b7dd0dfeec5d3ea4332f21d545383e90fdca0358/" class="commit-node commit-node--full">              <p>[SKIP]: State project goals in a README</p>

</a><a href="../97ec982181dad3d2765c18bd5440eccdbbc98500/" class="commit-node commit-node--full">              <p>[GENERATED]: Initial Commit</p>

</a><a href="../3fcacf98b7605fbfe2906a20f60d8c312c6e0a52/" class="commit-node commit-node--full">              <p>[GENERATED]: Generate db/schema.rb</p>

</a><a href="../dcabcd47c7eb462c872908b002a41be5df59eec5/" class="commit-node commit-node--full">              <p>Section 1: The Rails</p>

</a><a href="../08fb54ffa3ba144ad1f1bb0ac787b52410c6b73d/" class="commit-node commit-node--full">              <p>Mark Tasks as completed</p>

</a><a href="./" class="commit-node commit-node--full" aria-current="page">              <p>Delay multiple Tasks</p>

</a><a href="../2d12a66c44d7cc7e920a31aebd0c6ced6c886f16/" class="commit-node commit-node--full">              <p>Promote a Task from Delayed back to To-do</p>

</a><a href="../766e956f153bd69ced2ac7658e7b12ea95fed2db/" class="commit-node commit-node--full">              <p>Reopen a Task that was Completed</p>

</a><a href="../72814697aad135b2d6df8a629b462ac152b10281/" class="commit-node commit-node--full">              <p>Style with TailwindCSS</p>

</a><a href="../a062d3d1105d243386fc33a13216ead667137d5e/" class="commit-node commit-node--full">              <p>Section 2: The JavaScript</p>

</a><a href="../d41ae66683d55539e82f439e818ba6f4e60a1cd4/" class="commit-node commit-node--full">              <p>Open the <code>&lt;dialog&gt;</code> with a <code>&lt;button&gt;</code></p>

</a><a href="../fa19a0708b8f06a54e73435a61c7515dac5cbf4b/" class="commit-node commit-node--full">              <p>Open Bulk Action <code>&lt;form&gt;</code> modally</p>

</a><a href="../dd46eba462c76aff62ed92bce956c2e66aa07a2a/" class="commit-node commit-node--full">              <p>Close <dialog> when Bulk selection is empty</p>

</a><a href="../beae9178b49ccb96764d4b42b474a9776c1ac300/" class="commit-node commit-node--full">              <p>Fetch the <code>&lt;dialog&gt;</code> contents when opened</p>

</a><a href="../0f366feb8a8edd728134e4cf7a43a4bd06f3305b/" class="commit-node commit-node--full">              <p>Treat Lists as separate tab stops</p>

</a><a href="../bc43125b16e2399e8bec4b6cb15b6d5878447b37/" class="commit-node commit-node--full">              <p>Section 3: How can we improve accessibility?</p>

</a><a href="../6b6627d0dc9eecdd10297746c118d7bb68d586c2/" class="commit-node commit-node--full">              <p>Mark <main inert> when <dialog> open</p>

</a><a href="../748b365e5cb08ee91a5fdd7f41d7c96d67c122a5/" class="commit-node commit-node--full">              <p>Announce selected Task count</p>

</a>        </nav>
      </details>

      <article class="
        commit-content
        commit-content--double
        content__item
        content__item--grow
      ">
        <section class="commit commit--message">

          <h1 id="delay-multiple-tasks">Delay multiple Tasks</h1>

<p>As a second step toward executing status updates in-bulk, mark a group
of selected <code>Task</code> records as &ldquo;delayed&rdquo; by marking their new
<code>delayed_at</code> DATETIME column to &ldquo;now&rdquo;.</p>

<p>When a <code>Task</code> is either &ldquo;complete&rdquo; or &ldquo;delayed&rdquo;, exclude it from the
&ldquo;Todo&rdquo; section of the list.</p>

<p>To submit the shared <code>&lt;form&gt;</code> element to a different URL, declare the
&ldquo;Delay&rdquo; <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#attr-formaction"><code>&lt;button&gt;</code> element with the <code>formaction</code>
attribute</a> set to the <code>delays_path</code>.</p>

        </section>

          <aside class="commit commit--diff commit--long-content">
              <details
  id="app/controllers/delays_controller.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse app/controllers/delays_controller.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand app/controllers/delays_controller.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      app/controllers/delays_controller.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/app/controllers/delays_controller.rb b/app/controllers/delays_controller.rb
</span><span class="p">new file mode 100644
</span><span class="gh">index 0000000..9a1e183
</span><span class="gd">--- /dev/null
</span><span class="gi">+++ b/app/controllers/delays_controller.rb
</span><span class="p">@@ -0,0 +1,15 @@</span>
<span class="gi">+class DelaysController &lt; ApplicationController
+  def create
+    tasks = Task.where(id: event_params.fetch(:task_ids))
+
+    Task.transaction { tasks.each(&amp;:delay!) }
+
+    redirect_back fallback_location: root_url
+  end
+
+  private
+
+  def event_params
+    params.require(:event).permit(task_ids: [])
+  end
+end
</span></code></pre></div></details>

              <details
  id="app/models/task.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse app/models/task.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand app/models/task.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      app/models/task.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/app/models/task.rb b/app/models/task.rb
index 782976b..1a4c8cc 100644
</span><span class="gd">--- a/app/models/task.rb
</span><span class="gi">+++ b/app/models/task.rb
</span><span class="p">@@ -1,8 +1,13 @@</span>
 class Task &lt; ApplicationRecord
   scope :completed, -&gt; { where.not(completed_at: nil) }
<span class="gd">-  scope :todo, -&gt; { where(completed_at: nil) }
</span><span class="gi">+  scope :delayed, -&gt; { where.not(delayed_at: nil) }
+  scope :todo, -&gt; { where(completed_at: nil, delayed_at: nil) }
</span> 
   def complete!
     update!(completed_at: Time.current)
   end
<span class="gi">+
+  def delay!
+    update!(delayed_at: Time.current)
+  end
</span> end
</code></pre></div></details>

              <details
  id="app/views/tasks/index.html.erb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse app/views/tasks/index.html.erb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand app/views/tasks/index.html.erb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      app/views/tasks/index.html.erb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/app/views/tasks/index.html.erb b/app/views/tasks/index.html.erb
index e46a4f7..03191a3 100644
</span><span class="gd">--- a/app/views/tasks/index.html.erb
</span><span class="gi">+++ b/app/views/tasks/index.html.erb
</span><span class="p">@@ -1,3 +1,4 @@</span>
<span class="gi">+&lt;% if tasks.todo.any? %&gt;
</span> &lt;section&gt;
   &lt;%= form_with(scope: :event, url: completions_path) do |form| %&gt;
     &lt;fieldset&gt;
<span class="p">@@ -16,14 +17,38 @@</span>
         &lt;/tbody&gt;
         &lt;tfoot&gt;
           &lt;tr&gt;
<span class="gd">-            &lt;td&gt;&lt;%= form.button %&gt;&lt;/td&gt;
</span><span class="gi">+            &lt;% with_options scope: [:helpers, :submit, :event] do |action| %&gt;
+              &lt;td&gt;
+                &lt;%= form.button action.translate(:complete) %&gt;
+              &lt;/td&gt;
+
+              &lt;td&gt;
+                &lt;%= form.button action.translate(:delay), formaction: delays_path %&gt;
+              &lt;/td&gt;
+            &lt;% end %&gt;
</span>           &lt;/tr&gt;
         &lt;/tfoot&gt;
       &lt;/table&gt;
     &lt;/fieldset&gt;
   &lt;% end %&gt;
 &lt;/section&gt;
<span class="gi">+&lt;% end %&gt;
+
+&lt;% if tasks.delayed.any? %&gt;
+&lt;section&gt;
+  &lt;h2&gt;&lt;%= translate(".delayed") %&gt;&lt;/h2&gt;
+
+  &lt;table&gt;
+    &lt;% tasks.delayed.each do |task| %&gt;
+      &lt;tr&gt;
+        &lt;td&gt;&lt;%= task.name %&gt;&lt;/td&gt;
+      &lt;/tr&gt;
+    &lt;% end %&gt;
+  &lt;/table&gt;
+&lt;/section&gt;
+&lt;% end %&gt;
</span> 
<span class="gi">+&lt;% if tasks.completed.any? %&gt;
</span> &lt;section&gt;
   &lt;h2&gt;&lt;%= translate(".completed") %&gt;&lt;/h2&gt;
 
<span class="p">@@ -36,3 +61,4 @@</span>
     &lt;% end %&gt;
   &lt;/table&gt;
 &lt;/section&gt;
<span class="gi">+&lt;% end %&gt;
</span></code></pre></div></details>

              <details
  id="config/locales/en.yml"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse config/locales/en.yml</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand config/locales/en.yml</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      config/locales/en.yml
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/config/locales/en.yml b/config/locales/en.yml
index 9dbc994..c42c105 100644
</span><span class="gd">--- a/config/locales/en.yml
</span><span class="gi">+++ b/config/locales/en.yml
</span><span class="p">@@ -33,9 +33,11 @@</span> en:
   helpers:
     submit:
       event:
<span class="gd">-        submit: "Complete"
</span><span class="gi">+        complete: "Complete"
+        delay: "Delay"
</span> 
   tasks:
     index:
       completed: "Completed"
<span class="gi">+      delayed: "Delayed"
</span>       todo: "Tasks"
</code></pre></div></details>

              <details
  id="config/routes.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse config/routes.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand config/routes.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      config/routes.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/config/routes.rb b/config/routes.rb
index 1f3ca28..ddb5c00 100644
</span><span class="gd">--- a/config/routes.rb
</span><span class="gi">+++ b/config/routes.rb
</span><span class="p">@@ -1,6 +1,7 @@</span>
 Rails.application.routes.draw do
   # For details on the DSL available within this file, see https://guides.rubyonrails.org/routing.html
   resources :completions, only: :create
<span class="gi">+  resources :delays, only: :create
</span> 
   root to: "tasks#index"
 end
</code></pre></div></details>

              <details
  id="db/migrate/20200911021405_add_delayed_at_to_tasks.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse db/migrate/20200911021405_add_delayed_at_to_tasks.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand db/migrate/20200911021405_add_delayed_at_to_tasks.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      db/migrate/20200911021405_add_delayed_at_to_tasks.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/db/migrate/20200911021405_add_delayed_at_to_tasks.rb b/db/migrate/20200911021405_add_delayed_at_to_tasks.rb
</span><span class="p">new file mode 100644
</span><span class="gh">index 0000000..b17d826
</span><span class="gd">--- /dev/null
</span><span class="gi">+++ b/db/migrate/20200911021405_add_delayed_at_to_tasks.rb
</span><span class="p">@@ -0,0 +1,7 @@</span>
<span class="gi">+class AddDelayedAtToTasks &lt; ActiveRecord::Migration[6.1]
+  def change
+    change_table :tasks do |t|
+      t.timestamp :delayed_at, index: true
+    end
+  end
+end
</span></code></pre></div></details>

              <details
  id="db/schema.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse db/schema.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand db/schema.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      db/schema.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/db/schema.rb b/db/schema.rb
index 659234f..cfacc26 100644
</span><span class="gd">--- a/db/schema.rb
</span><span class="gi">+++ b/db/schema.rb
</span><span class="p">@@ -10,7 +10,7 @@</span>
 #
 # It's strongly recommended that you check this file into your version control system.
 
<span class="gd">-ActiveRecord::Schema.define(version: 2020_09_10_233326) do
</span><span class="gi">+ActiveRecord::Schema.define(version: 2020_09_11_021405) do
</span> 
   # These are extensions that must be enabled in order to support this database
   enable_extension "plpgsql"
<span class="p">@@ -20,7 +20,9 @@</span> ActiveRecord::Schema.define(version: 2020_09_10_233326) do
     t.datetime "completed_at"
     t.datetime "created_at", precision: 6, null: false
     t.datetime "updated_at", precision: 6, null: false
<span class="gi">+    t.datetime "delayed_at"
</span>     t.index ["completed_at"], name: "index_tasks_on_completed_at"
<span class="gi">+    t.index ["delayed_at"], name: "index_tasks_on_delayed_at"
</span>   end
 
 end
</code></pre></div></details>

              <details
  id="test/controllers/delays_controller_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/controllers/delays_controller_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/controllers/delays_controller_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/controllers/delays_controller_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/controllers/delays_controller_test.rb b/test/controllers/delays_controller_test.rb
</span><span class="p">new file mode 100644
</span><span class="gh">index 0000000..6015f81
</span><span class="gd">--- /dev/null
</span><span class="gi">+++ b/test/controllers/delays_controller_test.rb
</span><span class="p">@@ -0,0 +1,18 @@</span>
<span class="gi">+require "test_helper"
+
+class DelaysControllerTest &lt; ActionDispatch::IntegrationTest
+  test "#create marks a group of Tasks' delayed_at to now" do
+    freeze_time do
+      do_the_homework, pass_the_test = tasks(:do_the_homework, :pass_the_test)
+
+      post delays_path, params: {
+        event: {
+          task_ids: [do_the_homework, pass_the_test].map(&amp;:to_param)
+        }
+      }
+
+      assert_equal Time.now, do_the_homework.reload.delayed_at
+      assert_equal Time.now, pass_the_test.reload.delayed_at
+    end
+  end
+end
</span></code></pre></div></details>

              <details
  id="test/controllers/tasks_controller_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/controllers/tasks_controller_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/controllers/tasks_controller_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/controllers/tasks_controller_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/controllers/tasks_controller_test.rb b/test/controllers/tasks_controller_test.rb
</span><span class="p">new file mode 100644
</span><span class="gh">index 0000000..158392b
</span><span class="gd">--- /dev/null
</span><span class="gi">+++ b/test/controllers/tasks_controller_test.rb
</span><span class="p">@@ -0,0 +1,33 @@</span>
<span class="gi">+require "test_helper"
+
+class TasksControllerTest &lt; ActionDispatch::IntegrationTest
+  include ActionView::Helpers::TranslationHelper
+
+  test "#index omits the Todo list when there are no ready Task records" do
+    Task.todo.update_all(completed_at: nil)
+
+    get root_path
+
+    assert_no_section :todo
+  end
+
+  test "#index omits the Completed list when there are no delayed Task records" do
+    Task.completed.update_all(completed_at: nil)
+
+    get root_path
+
+    assert_no_section :completed
+  end
+
+  test "#index omits the Delayed list when there are no delayed Task records" do
+    get root_path
+
+    assert_no_section :delayed
+  end
+
+  def assert_no_section(i18n_key)
+    title = translate(i18n_key, scope: [:tasks, :index])
+
+    assert_select "section", count: 0, text: title
+  end
+end
</span></code></pre></div></details>

              <details
  id="test/models/task_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/models/task_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/models/task_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/models/task_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/models/task_test.rb b/test/models/task_test.rb
index cac4296..602ecc4 100644
</span><span class="gd">--- a/test/models/task_test.rb
</span><span class="gi">+++ b/test/models/task_test.rb
</span><span class="p">@@ -10,6 +10,16 @@</span> class TaskTest &lt; ActiveSupport::TestCase
     assert_not_includes completed, do_the_homework
   end
 
<span class="gi">+  test ".delayed excludes Task records with a nil delayed_at" do
+    read_the_book, do_the_homework = tasks(:read_the_book, :do_the_homework)
+    do_the_homework.delay!
+
+    delayed = Task.delayed
+
+    assert_not_includes delayed, read_the_book
+    assert_includes delayed, do_the_homework
+  end
+
</span>   test ".todo excludes Task records with a completed_at" do
     read_the_book, do_the_homework = tasks(:read_the_book, :do_the_homework)
 
<span class="p">@@ -19,6 +29,16 @@</span> class TaskTest &lt; ActiveSupport::TestCase
     assert_includes todo, do_the_homework
   end
 
<span class="gi">+  test ".todo excludes Task records with a delayed_at" do
+    do_the_homework, pass_the_test = tasks(:do_the_homework, :pass_the_test)
+    do_the_homework.delay!
+
+    todo = Task.todo
+
+    assert_not_includes todo, do_the_homework
+    assert_includes todo, pass_the_test
+  end
+
</span>   test "#complete! marks a Task's completed_at to now" do
     freeze_time do
       pass_the_test = tasks(:pass_the_test)
<span class="p">@@ -28,4 +48,14 @@</span> class TaskTest &lt; ActiveSupport::TestCase
       end
     end
   end
<span class="gi">+
+  test "#delay! marks a Task's delayed_at to now" do
+    freeze_time do
+      pass_the_test = tasks(:pass_the_test)
+
+      assert_changes -&gt; { pass_the_test.delayed_at }, from: nil, to: Time.current do
+        pass_the_test.delay!
+      end
+    end
+  end
</span> end
</code></pre></div></details>

              <details
  id="test/system/tasks_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/system/tasks_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/system/tasks_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/system/tasks_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/system/tasks_test.rb b/test/system/tasks_test.rb
index d5d6110..0f3eaa1 100644
</span><span class="gd">--- a/test/system/tasks_test.rb
</span><span class="gi">+++ b/test/system/tasks_test.rb
</span><span class="p">@@ -9,25 +9,41 @@</span> class TasksTest &lt; ApplicationSystemTestCase
     visit root_path
     check do_the_homework.name
     check pass_the_test.name
<span class="gd">-    click_on submit(:event)
</span><span class="gi">+    click_on submit(:event, :complete)
</span> 
<span class="gd">-    within_section :todo do
-      assert_no_text do_the_homework.name
-      assert_no_text pass_the_test.name
-    end
</span><span class="gi">+    assert_no_section :todo
</span>     within_section :completed do
       assert_text do_the_homework.name
       assert_text pass_the_test.name
     end
   end
 
<span class="gi">+  test "marks multiple Tasks as delayed" do
+    do_the_homework, pass_the_test = tasks(:do_the_homework, :pass_the_test)
+
+    visit root_path
+    check do_the_homework.name
+    check pass_the_test.name
+    click_on submit(:event, :delay)
+
+    assert_no_section :todo
+    within_section :delayed do
+      assert_text do_the_homework.name
+      assert_text pass_the_test.name
+    end
+  end
+
+  def assert_no_section(i18n_key)
+    assert_no_text translate(i18n_key, scope: [:tasks, :index])
+  end
+
</span>   def within_section(i18n_key, &amp;block)
     title = translate(i18n_key, scope: [:tasks, :index])
 
     within("section", text: title, &amp;block)
   end
 
<span class="gd">-  def submit(i18n_key)
-    translate(:submit, scope: [:helpers, :submit, i18n_key])
</span><span class="gi">+  def submit(i18n_key, action)
+    translate(action, scope: [:helpers, :submit, i18n_key])
</span>   end
 end
</code></pre></div></details>

          </aside>
      </article>
    </main>
  </body>
</html>
