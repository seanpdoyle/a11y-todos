<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Use the title from a page's frontmatter if it has one -->
    <title>Promote a Task from Delayed back to To-do
</title>
    <link href="../../stylesheets/site.css" rel="stylesheet" />
    <script src="../../javascripts/site.js"></script>
  </head>
  <body class="page">
    <header class="header">
      <h1 class="header__name">
<a href="../../">          a11y-todos
</a>      </h1>


      <nav class="
        header__navigation
        navigation
        
      ">
<a href="../53a20a7dbbb66541019a9f657c84f9cac6101611/">              &#8592; Previous
</a>
<a href="../3d7ef136f0eaa8ee4748b3f81680a11379430943/">              Next &#8594;
</a>      </nav>
    </header>

    <main class="content">
      <details class="accordion content__item">
        <summary class="accordion__summary">
          <div class="accordion__closed">
            <nav class="
              commit-history
              u-db-overflow-y--auto
              u-mb-overflow-x--scroll
            ">
                <a href="../4940917510781bfb9d2314695ec402b2e1609f98/" class="commit-node commit-node--collapsed" title="[SKIP]: Create `git-read` GitHub Action
"></a>
                <a href="../4bda2844904815465f33094f6e5dbc9418b0efa0/" class="commit-node commit-node--collapsed" title="[SKIP]: State project goals in a README"></a>
                <a href="../850de19eef9666c3de8829e7749b272165bef616/" class="commit-node commit-node--collapsed" title="[GENERATED]: Initial Commit
"></a>
                <a href="../7d3c5439519d8b9629f3096b4da6bf46efb214f7/" class="commit-node commit-node--collapsed" title="[GENERATED]: Generate db/schema.rb
"></a>
                <a href="../ada2db0c84b8d834edd6eaa771fe60082d0588c9/" class="commit-node commit-node--collapsed" title="Mark Tasks as completed
"></a>
                <a href="../7dc0ebbb5d2c9ba1552606c62a5d72b0bc0f2d1d/" class="commit-node commit-node--collapsed" title="[SETUP]: Install TailwindCSS
"></a>
                <a href="../53a695a747f52bf2e0614ba54ad54d6571c69238/" class="commit-node commit-node--collapsed" title="Delay multiple Tasks
"></a>
                <a href="../4961f9159f8fbc28831e57960911a7aec905185b/" class="commit-node commit-node--collapsed" title="Open the `&lt;dialog&gt;` with a `&lt;button&gt;`
"></a>
                <a href="../3396cd59ea9a6316e8ad4299eea5e63a410c9e99/" class="commit-node commit-node--collapsed" title="Open Bulk Action `&lt;form&gt;` modally
"></a>
                <a href="../efa1db5372d93031e0ca14c4c2bf0080021f0342/" class="commit-node commit-node--collapsed" title="Close &lt;dialog&gt; when Bulk selection is empty
"></a>
                <a href="../209926fd8f2dcadd580c55cc1c0b92073d713bf8/" class="commit-node commit-node--collapsed" title="Mark &lt;main inert&gt; when &lt;dialog&gt; open
"></a>
                <a href="../53a20a7dbbb66541019a9f657c84f9cac6101611/" class="commit-node commit-node--collapsed" title="Declare as role=&quot;grid&quot;
"></a>
                <a href="./" class="commit-node commit-node--collapsed" title="Promote a Task from Delayed back to To-do
" aria-current="page"></a>
                <a href="../3d7ef136f0eaa8ee4748b3f81680a11379430943/" class="commit-node commit-node--collapsed" title="Reopen a Task that was Completed
"></a>
                <a href="../2db09829f0c6c5a0d560b266794f1500e65d41e0/" class="commit-node commit-node--collapsed" title="Treat Lists as separate tab stops
"></a>
            </nav>

            <div class="accordion__toggle">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--desktop"><title>Expand History</title>
  <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L10.293 8 4.646 2.354a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--mobile"><title>Expand History</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>

            </div>
          </div>

          <div class="accordion__opened">
            <div class="accordion__toggle accordion__toggle--fill">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--desktop"><title>Collapse History</title>
  <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 010 .708L5.707 8l5.647 5.646a.5.5 0 01-.708.708l-6-6a.5.5 0 010-.708l6-6a.5.5 0 01.708 0z" clip-rule="evenodd"></path>
</svg>


              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="accordion--mobile"><title>Collapse History</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>

            </div>
          </div>
        </summary>

        <nav class="
          commit-history
          commit-history--full
          u-db-overflow-y--auto
          u-mb-overflow-x--scroll
        ">
<a href="../4940917510781bfb9d2314695ec402b2e1609f98/" class="commit-node commit-node--full">              <p>[SKIP]: Create <code>git-read</code> GitHub Action</p>

</a><a href="../4bda2844904815465f33094f6e5dbc9418b0efa0/" class="commit-node commit-node--full">              <p>[SKIP]: State project goals in a README</p>

</a><a href="../850de19eef9666c3de8829e7749b272165bef616/" class="commit-node commit-node--full">              <p>[GENERATED]: Initial Commit</p>

</a><a href="../7d3c5439519d8b9629f3096b4da6bf46efb214f7/" class="commit-node commit-node--full">              <p>[GENERATED]: Generate db/schema.rb</p>

</a><a href="../ada2db0c84b8d834edd6eaa771fe60082d0588c9/" class="commit-node commit-node--full">              <p>Mark Tasks as completed</p>

</a><a href="../7dc0ebbb5d2c9ba1552606c62a5d72b0bc0f2d1d/" class="commit-node commit-node--full">              <p>[SETUP]: Install TailwindCSS</p>

</a><a href="../53a695a747f52bf2e0614ba54ad54d6571c69238/" class="commit-node commit-node--full">              <p>Delay multiple Tasks</p>

</a><a href="../4961f9159f8fbc28831e57960911a7aec905185b/" class="commit-node commit-node--full">              <p>Open the <code>&lt;dialog&gt;</code> with a <code>&lt;button&gt;</code></p>

</a><a href="../3396cd59ea9a6316e8ad4299eea5e63a410c9e99/" class="commit-node commit-node--full">              <p>Open Bulk Action <code>&lt;form&gt;</code> modally</p>

</a><a href="../efa1db5372d93031e0ca14c4c2bf0080021f0342/" class="commit-node commit-node--full">              <p>Close <dialog> when Bulk selection is empty</p>

</a><a href="../209926fd8f2dcadd580c55cc1c0b92073d713bf8/" class="commit-node commit-node--full">              <p>Mark <main inert> when <dialog> open</p>

</a><a href="../53a20a7dbbb66541019a9f657c84f9cac6101611/" class="commit-node commit-node--full">              <p>Declare as role=&quot;grid&quot;</p>

</a><a href="./" class="commit-node commit-node--full" aria-current="page">              <p>Promote a Task from Delayed back to To-do</p>

</a><a href="../3d7ef136f0eaa8ee4748b3f81680a11379430943/" class="commit-node commit-node--full">              <p>Reopen a Task that was Completed</p>

</a><a href="../2db09829f0c6c5a0d560b266794f1500e65d41e0/" class="commit-node commit-node--full">              <p>Treat Lists as separate tab stops</p>

</a>        </nav>
      </details>

      <article class="
        commit-content
        commit-content--double
        content__item
        content__item--grow
      ">
        <section class="commit commit--message">

          <h1 id="promote-a-task-from-delayed-back-to-to-do">Promote a Task from Delayed back to To-do</h1>

<p>To make the page more interactive, add a &ldquo;Promote&rdquo; button to move Tasks
that have been marked as &ldquo;Delayed&rdquo; back to &ldquo;Todo&rdquo;.</p>

<p>Instead of acting as a bulk action, the <code>PromotionsController#create</code>
operates on a single <code>Task</code> record.</p>

        </section>

          <aside class="commit commit--diff commit--long-content">
              <details
  id="app/controllers/promotions_controller.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse app/controllers/promotions_controller.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand app/controllers/promotions_controller.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      app/controllers/promotions_controller.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/app/controllers/promotions_controller.rb b/app/controllers/promotions_controller.rb
</span><span class="p">new file mode 100644
</span><span class="gh">index 0000000..1e71b02
</span><span class="gd">--- /dev/null
</span><span class="gi">+++ b/app/controllers/promotions_controller.rb
</span><span class="p">@@ -0,0 +1,9 @@</span>
<span class="gi">+class PromotionsController &lt; ApplicationController
+  def create
+    task = Task.find(params[:task_id])
+
+    task.promote!
+
+    redirect_back fallback_location: root_url
+  end
+end
</span></code></pre></div></details>

              <details
  id="app/models/task.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse app/models/task.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand app/models/task.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      app/models/task.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/app/models/task.rb b/app/models/task.rb
index 1a4c8cc..0cd29c5 100644
</span><span class="gd">--- a/app/models/task.rb
</span><span class="gi">+++ b/app/models/task.rb
</span><span class="p">@@ -10,4 +10,8 @@</span> class Task &lt; ApplicationRecord
   def delay!
     update!(delayed_at: Time.current)
   end
<span class="gi">+
+  def promote!
+    update!(delayed_at: nil)
+  end
</span> end
</code></pre></div></details>

              <details
  id="app/views/tasks/index.html.erb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse app/views/tasks/index.html.erb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand app/views/tasks/index.html.erb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      app/views/tasks/index.html.erb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/app/views/tasks/index.html.erb b/app/views/tasks/index.html.erb
index 8d8e75b..f24eeae 100644
</span><span class="gd">--- a/app/views/tasks/index.html.erb
</span><span class="gi">+++ b/app/views/tasks/index.html.erb
</span><span class="p">@@ -33,6 +33,23 @@</span>
   &lt;table role="grid"&gt;
     &lt;%= render("rows", tasks: tasks.delayed) do |task| %&gt;
       &lt;td role="cell"&gt;&lt;%= task.name %&gt;&lt;/td&gt;
<span class="gi">+
+      &lt;td role="cell"&gt;
+        &lt;%= form_with(scope: :event, url: task_promotions_path(task)) do |form| %&gt;
+          &lt;%= form.button id: dom_id(task, :promote), class: "
+            border
+            focus:outline-none
+            focus:shadow-outline
+            hover:shadow-outline
+            px-2
+            py-1
+            rounded
+          " do %&gt;
+            &lt;%= translate(:promote, scope: [:helpers, :submit, :event]) %&gt;
+            &lt;span class="sr-only"&gt;&lt;%= task.name %&gt;&lt;/span&gt;
+          &lt;% end %&gt;
+        &lt;% end %&gt;
+      &lt;/td&gt;
</span>     &lt;% end %&gt;
   &lt;/table&gt;
 &lt;/section&gt;
</code></pre></div></details>

              <details
  id="config/locales/en.yml"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse config/locales/en.yml</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand config/locales/en.yml</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      config/locales/en.yml
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/config/locales/en.yml b/config/locales/en.yml
index b82041a..8ef268a 100644
</span><span class="gd">--- a/config/locales/en.yml
</span><span class="gi">+++ b/config/locales/en.yml
</span><span class="p">@@ -42,6 +42,7 @@</span> en:
         close: "Close"
         complete: "Complete"
         delay: "Delay"
<span class="gi">+        promote: "Promote"
</span> 
   tasks:
     index:
</code></pre></div></details>

              <details
  id="config/routes.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse config/routes.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand config/routes.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      config/routes.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/config/routes.rb b/config/routes.rb
index ddb5c00..e003fb8 100644
</span><span class="gd">--- a/config/routes.rb
</span><span class="gi">+++ b/config/routes.rb
</span><span class="p">@@ -3,5 +3,9 @@</span> Rails.application.routes.draw do
   resources :completions, only: :create
   resources :delays, only: :create
 
<span class="gi">+  resources :tasks, only: [] do
+    resources :promotions, only: :create
+  end
+
</span>   root to: "tasks#index"
 end
</code></pre></div></details>

              <details
  id="test/controllers/promotions_controller_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/controllers/promotions_controller_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/controllers/promotions_controller_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/controllers/promotions_controller_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/controllers/promotions_controller_test.rb b/test/controllers/promotions_controller_test.rb
</span><span class="p">new file mode 100644
</span><span class="gh">index 0000000..8f89b89
</span><span class="gd">--- /dev/null
</span><span class="gi">+++ b/test/controllers/promotions_controller_test.rb
</span><span class="p">@@ -0,0 +1,12 @@</span>
<span class="gi">+require "test_helper"
+
+class PromotionsControllerTest &lt; ActionDispatch::IntegrationTest
+  test "#create marks a Task's delayed_at to nil" do
+    do_the_homework = tasks(:do_the_homework)
+    do_the_homework.delay!
+
+    post task_promotions_path(do_the_homework)
+
+    assert_nil do_the_homework.reload.delayed_at
+  end
+end
</span></code></pre></div></details>

              <details
  id="test/controllers/tasks_controller_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/controllers/tasks_controller_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/controllers/tasks_controller_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/controllers/tasks_controller_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/controllers/tasks_controller_test.rb b/test/controllers/tasks_controller_test.rb
index 158392b..70f1e3c 100644
</span><span class="gd">--- a/test/controllers/tasks_controller_test.rb
</span><span class="gi">+++ b/test/controllers/tasks_controller_test.rb
</span><span class="p">@@ -25,6 +25,14 @@</span> class TasksControllerTest &lt; ActionDispatch::IntegrationTest
     assert_no_section :delayed
   end
 
<span class="gi">+  test "#index omits the Todo list when there are no Task records to be worked on" do
+    Task.todo.update_all(completed_at: Time.current)
+
+    get root_path
+
+    assert_no_section :todo
+  end
+
</span>   def assert_no_section(i18n_key)
     title = translate(i18n_key, scope: [:tasks, :index])
 
</code></pre></div></details>

              <details
  id="test/models/task_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/models/task_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/models/task_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/models/task_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/models/task_test.rb b/test/models/task_test.rb
index 602ecc4..6cac316 100644
</span><span class="gd">--- a/test/models/task_test.rb
</span><span class="gi">+++ b/test/models/task_test.rb
</span><span class="p">@@ -58,4 +58,15 @@</span> class TaskTest &lt; ActiveSupport::TestCase
       end
     end
   end
<span class="gi">+
+  test "#promote! marks a Task's delayed_at to nil" do
+    freeze_time do
+      do_the_homework = tasks(:do_the_homework)
+      do_the_homework.delay!
+
+      assert_changes -&gt; { do_the_homework.delayed_at }, from: Time.current, to: nil do
+        do_the_homework.promote!
+      end
+    end
+  end
</span> end
</code></pre></div></details>

              <details
  id="test/system/tasks_test.rb"
  open
  class="file"
>
  <summary class="file__name">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--close"><title>Collapse test/system/tasks_test.rb</title>
  <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 01.708 0l6 6a.5.5 0 01-.708.708L8 5.707l-5.646 5.647a.5.5 0 01-.708-.708l6-6z" clip-rule="evenodd"></path>
</svg>


    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" role="img" class="file__toggle file__toggle--open"><title>Expand test/system/tasks_test.rb</title>
  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"></path>
</svg>


    <code>
      test/system/tasks_test.rb
    </code>
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/test/system/tasks_test.rb b/test/system/tasks_test.rb
index 6b9b29e..b28db86 100644
</span><span class="gd">--- a/test/system/tasks_test.rb
</span><span class="gi">+++ b/test/system/tasks_test.rb
</span><span class="p">@@ -81,6 +81,19 @@</span> class TasksTest &lt; ApplicationSystemTestCase
     end
   end
 
<span class="gi">+  test "promotes delayed Task back to Todo" do
+    do_the_homework = tasks(:do_the_homework)
+    do_the_homework.delay!
+
+    visit root_path
+    within_task(do_the_homework.name) { click_on submit(:event, :promote) }
+
+    assert_no_section :delayed
+    within_section :todo do
+      assert_text do_the_homework.name
+    end
+  end
+
</span>   def send_keys(*arguments)
     (active_element || find("body")).send_keys(*arguments)
   end
<span class="p">@@ -91,6 +104,10 @@</span> class TasksTest &lt; ApplicationSystemTestCase
     JS
   end
 
<span class="gi">+  def within_task(text, &amp;block)
+    within("tr", text: text, &amp;block)
+  end
+
</span>   def assert_no_section(i18n_key)
     assert_no_text translate(i18n_key, scope: [:tasks, :index])
   end
</code></pre></div></details>

          </aside>
      </article>
    </main>
  </body>
</html>
